let myChart,pathChart,campaignChart;function updateChart(t){if(document.getElementById("dataChart")){const e=document.getElementById("dataChart");if(!e)return;const a=e.getContext("2d");let r=t.reduce(((t,e)=>{const a=e.geo?.ip?.replace("::ffff:","").replace("::1","localhost")||"Unknown";return t[a]=(t[a]||0)+1,t}),{}),n=Object.keys(r),o=Object.values(r);myChart&&myChart.destroy(),myChart=new Chart(a,{type:"bar",data:{labels:n,datasets:[{label:"Number of Events per IP",data:o,backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0},x:{beginAtZero:!1,title:{display:!0,text:"IP Addresses"}}}}})}}function updatePathChart(t){const e=document.getElementById("pathChart");if(e){const a=e.getContext("2d");let r=t.reduce(((t,e)=>{let a=e.path.replaceAll(".gif","").replaceAll("/","")||"Unknown",r=new Date(e.decay).toISOString().split("T")[0];return t[a]=t[a]||{},t[a][r]=(t[a][r]||0)+1,t}),{}),n=Object.keys(r),o=[];n.forEach((t=>{o=o.concat(Object.keys(r[t]))}));let l=[...new Set(o)].sort(),d=n.map((t=>{let e=l.map((e=>({x:e,y:r[t][e]||0})));return{label:t,data:e,fill:!1,borderColor:getRandomColor(),tension:.1}}));pathChart&&pathChart.destroy(),pathChart=new Chart(a,{type:"line",data:{labels:l,datasets:d},options:{scales:{y:{beginAtZero:!0}}}})}}function updateCampaignChart(t){const e=document.getElementById("campaignChart");if(e){const a=e.getContext("2d");let r=t.reduce(((t,e)=>{let a=e.campaignID||"Unknown";return t[a]=(t[a]||0)+1,t}),{}),n=Object.keys(r),o=Object.values(r);campaignChart&&campaignChart.destroy(),campaignChart=new Chart(a,{type:"bar",data:{labels:n,datasets:[{label:"Number of Events per Campaign",data:o,backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0},x:{beginAtZero:!1,title:{display:!0,text:"Campaigns"}}}}})}}function getRandomColor(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}